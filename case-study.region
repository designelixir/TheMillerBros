<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="stylesheet" href="https://use.typekit.net/ctq0biw.css">
    <link rel="stylesheet" href="styles/case-study.less">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    {squarespace-headers}
  </head>
    <body id="{squarespace.page-id}" class="{squarespace.page-classes} texture">
        <header class="site-header">
            <squarespace:navigation navigationId="siteNav" template="site-navigation" />
        </header>

     <div class="loader-wrapper texture">
            <div class="loader-contents">

                <img style="height: 100px; padding: 5px 50px;" src="assets/steering-wheel.svg"/>
                <div class='progress' id="progress_div">
                    <div class='bar' id='bar1'></div>
                    <div class='percent' id='percent1'></div>
                </div>                
                <input type="hidden" id="progress_width" value="0">
            </div>
        </div>

   
    <section id="featured-projects">
        <div id="slide-container">
        {.repeated section items}
            <div class="slide">
                <div class="project">
                    <div class="project-wrapper" style="display: none;width: 100%; height: 100%; position: relative;">
                        <div class="vimeo-bg-wrapper" style="background-image: url('{structuredContent.oembed.thumbnailUrl}?format=original');" >
                            <iframe class="vimeo-bg-iframe" src='https://player.vimeo.com/video/{customContent.vimeocode}?background=1&autoplay=1&loop=1&byline=0&title=0' frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                        </div>

                        <div class="title-container">
                        {#  LINKED SLIDERS  }
                        {.equal? customContent.customType "LinkedSlider"} 
                            <div class="title-wrapper" onclick="location.href='{customContent.clickthru}'">
                                <a href='{customContent.clickthru}' style="text-decoration: none; ">
                                    <span id="linked-slider-wrapper">
                                        <h1 class="link-title">{title}</h1>
                                        <h4 style="color: white;">{body}</h4> 
                                    </span>
                                </a>
                            </div>
                            {.or}
                            {#  PROJECT SLIDERS}
                            <div class="title-wrapper ">
                                <span class="summary-title toggle-case-study">
                                    <span id="summary-title-button-wrapper">
                                        <span id="title-brand-wrapper">
                                            <h1 class="project-title">{title}</h1>
                                            <h4 class="project-brand">{customContent.brand}</h4> 
                                        </span>
                                        
                                    </span>                    
                                </span>
                            </div>
                            {.end}
                        </div>
                    </div>
                </div>
            </div>
                {#  CASE STUDY WINDOWS  }
                {.equal? customContent.customType "Project"} 
                    <div class="case-study-window texture" style="display: none; position: absolute; top: 0; left: 0; z-index: 25; height: 100vh; width: 100vw;">
                        <div class="project-case-study-wrapper">
                            {#  project navigation  }
                            <div class="case-study-nav inset-box-shadow">
                                <span>               
                                    <img src="../assets/miller-bros-lettermark-white.svg" alt="Miller Bros Lettermark Logo" />
                                </span>
                                <span style="justify-content: flex-end;">
                                    <button id="toggle-fullscreen-{id}" class="expand-button hover-indication" aria-label="Toggle Full Screen Video Window"></button>
                                    <button class="circle-button-blue toggle-case-study" id="toggle-close-{id}" aria-label="Close Portfolio Video Window"></button>
                                </span>
                            </div>

                            {#  iframe  }
                            <div class="fullcut-iframe-container" style="background-image: url('{structuredContent.oembed.thumbnailUrl}?format=original');">
                                <div class="fullcut-iframe-wrapper" style="padding:56.25% 0 0 0; position:relative; overflow-y: hidden; ">
                                    <iframe id="fullcut-iframe" class="case-study-iframe" src="https://player.vimeo.com/video/{customContent.vimeocode}?h=5d02ec9719&title=0&byline=0&portrait=0" style="position:absolute;top:0;left:0;width:100%; height: 100%;  overflow-y: hidden; max-width: 1700px; max-height: 950px;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                            


                            {#  project details  }
                            <div class="case-study-title fade-in ">
                                <h1>{title}</h1>
                                <h5>{customContent.shortdescription}</h5>
                            </div>
                            <div class="case-study-text tan-texture inset-box-shadow">
                                <span class="case-study-block" id="summary-credits-block">
                                    <span class="summary">
                                        <h4 style="padding-bottom: 10px; width: 50%;" class="yellow-line">Project Summary </h4>   
                                        <script>var fixed = body.stringify(); console.log(fixed) </script>
                                        <p>{body}</p>
                                    </span>
                                    <span class="credits">
                                        <h4 style="padding-bottom: 10px" class="yellow-line"> Credits </h4>
                                        <p>{customContent.credits.html}</p>
                                    </span>
                                </span>
                                
                                {#  TESTIMONIAL  }
                                <span class="case-study-block">
                                    <span class="case-study-testimonial">
                                        {.if customContent.testimonial}
                                            <span id="testimonial">
                                                <p>{customContent.testimonial}</p>
                                            </span>
                                            <h5>-{customContent.testimonial-name}</h5>
                                        {.or}
                                        
                                        {.end}
                                    </span>
                                </span>

                                <span class="case-study-text-block">
                                    <span>
                                        {.if customContent.additional-video1}
                                        <h4>Additional Videos </h4>
                                        <span class="yellow-line"></span>
                                        <br>
                                            <div class="extra-video">
                                            <div style="padding:56.25% 0 0 0;position:relative;">
                                                <iframe src="https://player.vimeo.com/video/{customContent.additional-video1}?h=a80429b32e&title=0&byline=0&portrait=0" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
                                            </div>
                                        {.or}
                                        {.end}
                                        {.if customContent.additional-video2}
                                            <div class="extra-video">
                                            <div style="padding:56.25% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/{customContent.additional-video2}?h=a80429b32e&title=0&byline=0&portrait=0" style="position:absolute;top:0;left:0;width:100%;height:100%;" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe></div><script src="https://player.vimeo.com/api/player.js"></script>
                                            </div>
                                        {.or}
                                        {.end}

                                    </span>
                                </span>
                            </div>
                            {#  BEHIND THE SCENES  }
                                <div id="bts" class="inset-box-shadow">
                                    <h6 style="text-align: center;"> Behind the Scenes </h6>

                                    <div id="bts-photos-grid" >
                                        {.repeated section customContent.behindthescenes}
                                            <img class="bts-img" src="{assetUrl}"/>
                                        {.end}
                                    </div>
                                    <span style="display: flex; align-items: center; justify-content: center; padding: 50px; color: white;">
                                        <button class="circle-button-blue toggle-case-study" id="toggle-close-{id}" style="width: 100%;" aria-label="Close Portfolio Video Window"></button>
                                    </span>
                                </div> 
                        </div>
                    </div>
                {.end}
            {.end}

            <div id="project-counter">
                <img src="../assets/tan-textured-circle.svg" class="counter">
            </div>
        </div>
        <div id="next-slide">
            <img id="slide-arrow" src="../assets/nav-arrow.svg" alt="next slide arrow" />
        </div>
        
    </section>
  




    <footer class="texture">
    <div class="footer-wrapper tan-texture inset-box-shadow">
    <div class="footer-left" >
      <img  style="height: 100%; max-height: 100px;" src="../assets/Miller-Bros-Lettermark-Black.svg"/>
    </div>
    <div class="footer-right">
        <div style="width: 50%; border: 1px solid red; text-align: center;">
          <img style="height: 100px; margin: 5px;" src="../assets/Lab-Logo.svg"/>
          <p> A creative, collaborative studio.</p><br>
          <p>3 S. Black Street<br>Bozeman, MT</p>

        </div>
        <div style="width: 50%; border: 1px solid red; display: flex; flex-direction: column; ">
          <squarespace:block-field id="footer-social-icons" columns="12"/>
          <squarespace:block-field id="footer-button" columns="12"/>

          
        </div>
    </div>
  </div>

  <div class="footer-navigation-wrapper">
        <p>Copyright The Miller Bros LLC &copy; 2021 </p>
        <a href="https://designelixir.studio" target="_blank" style='font-size: 12px; color: white; opacity: 0.75'> Made with &hearts; by Design Elixir</a>
  </div>
  </footer>



    <!-- combo and minify scripts when not logged in -->
    <squarespace:script src="site.js" combo="{.if authenticatedAccount}false{.or}true{.end}" />

    <!-- other scripts, and footer code injection -->
    {squarespace-footers}

  </body>
</html>
<script>


var allSlides = document.getElementsByClassName('project');
console.log(allSlides)
var active = 0;
var counter = allSlides.length;



  $('.counter').click(function(){
    console.log('something happened')
  })
  
  $('#next-slide').click(function(){
    $('.counter:eq('+active+')').attr("src", "../assets/tan-textured-circle.svg")  
    if(counter > active + 1){active++;} 
    else {active = 0;}
    var activate = allSlides[active];
    activate.scrollIntoView();
    activate.style.left = "0";
    $('.counter:eq('+active+')').attr("src", "../assets/yellow-textured-circle.svg")  
    clearInterval(timerID);
  })
  
  var timerID = 
  setInterval(function() {
  $('.counter:eq('+active+')').attr("src", "../assets/tan-textured-circle.svg")  
      if(active >= counter - 1){active = 0;} 
      else {active = active + 1;}
      var activate = allSlides[active];
      activate.scrollIntoView();
      $('.counter:eq('+active+')').attr("src", "../assets/yellow-textured-circle.svg")  
  }, 10000);


$('.toggle-case-study').click(function(){
  clearInterval(timerID);
  var count = $('.toggle-case-study').data("count") || 0;
  $('.toggle-case-study').data("count", ++count);
  console.log("count is "+count)
  if ((count % 2) != 0 ){
    $('.case-study-window:eq('+active+')').slideDown(500);
  } else {
    $('.case-study-window:eq('+active+')').slideUp(500);
    $('.case-study-iframe:eq('+active+')').attr("src", $('.case-study-iframe:eq('+active+')').attr("src"));
    $('.additional-video-iframe-one:eq('+active+')').attr("src", $('.additional-video-iframe-one:eq('+active+')').attr("src"));
    $('.additional-video-iframe-two:eq('+active+')').attr("src", $('.additional-video-iframe-two:eq('+active+')').attr("src"));
  }
});

var sliderTop = $("#featured-projects").offset().top; //gets offset of header
var sliderHeight = $("#featured-projects").outerHeight(); //gets height of header

$(window).scroll(function(){
    if($(window).scrollTop() > (sliderTop + sliderHeight)){
      clearInterval(timerID);
    }
});


// LOADING BAR 
document.onreadystatechange = function(e){
  if(document.readyState=="interactive"){
    var all = document.getElementsByTagName("*");
    for (var i=0, max=all.length; i < max; i++) {
      set_ele(all[i]);
    }
  }
}
function check_element(ele){
  var all = document.getElementsByTagName("*");
  var totalele=all.length;
  var per_inc=100/all.length;

  if($(ele).on()){
    var prog_width=per_inc+Number(document.getElementById("progress_width").value);
    document.getElementById("progress_width").value=prog_width;
    $("#bar1").animate({width:prog_width+"%"},10,function(){
      if(document.getElementById("bar1").style.width=="100%")
      {
        $("header").fadeIn(1000);
        $(".loader-wrapper").fadeOut(1000);
        $(".loader-wrapper").css("display","none")
        $('#next-slide').fadeIn(1000);
        $('#project-counter').fadeIn(1000);
        $(".loader-contents").css("display","none")
        $(".title-container").css("animation","fade-in 1s cubic-bezier(.39,.575,.565,1.000) both");
        $(".project-wrapper").fadeIn(1000);
        $("iframe").fadeIn(1000);
        $('.counter:eq('+active+')').attr("src", "../assets/yellow-textured-circle.svg")  

      }			
    });
  }else{
    set_ele(ele);}
}
function set_ele(set_element){check_element(set_element);}

// //// //// //// //// //// //// //// //// //// //// //// //// //

// counter dots
  for (let i = 1; i < counter; i++) {
    $("#project-counter").append($(".counter").last().clone(true));
  }

$('.back-to-top').click(function(){$('.project-case-study-window').scrollTop(0);})
$('.expand-button').click(function() { let elem = document.getElementById("fullcut-iframe"); elem.requestFullscreen()})


// MEDIA QUERY 
function mediaQuery(x800) {
  if (x800.matches) { 
    $('.project-title').css({"font-size":"55px", "line-height":"55px"});
    $('.link-title').css({"font-size":"55px" , "line-height":"55px"});
    $('.case-study-block').css({"display":"block"})
    $('.summary').css({"width":"100%"});
    $('.credits').css({"width":"100%"});
    $('.yellow-line').css("width", "75%");
    $('#bts-photos-grid').css('column-count', '2')

  } else {
    $('.project-title').css({"font-size":"75px", "line-height":"75px"});
    $('.link-title').css({"font-size":"75px", "line-height":"75px"});
    $('.case-study-block').css({"display":"inline-flex"})
    $('.summary').css({"width":"70%"});
    $('.credits').css({"width":"30%"});
    $('#bts-photos-grid').css('column-count', '3')
    $('.yellow-line').css({"width":"50%", "min-width":"150px"});
  }
}
var x800 = window.matchMedia("(max-width: 800px)")
mediaQuery(x800) 
x800.addListener(mediaQuery); 


</script>